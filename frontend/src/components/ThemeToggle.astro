---
---

<button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
  <span class="theme-icon">ðŸ”„</span>
</button>

<style>
  .theme-toggle {
    position: fixed;
    top: 1rem;
    right: 1rem;
    z-index: 100;
    width: 3rem;
    height: 3rem;
    border-radius: 50%;
    background: var(--color-wrap);
    box-shadow: var(--shadow-card);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    border: 2px solid var(--color-border);
    cursor: pointer;
  }

  .theme-toggle:hover {
    transform: scale(1.1);
    box-shadow: var(--shadow-card-hover);
  }

  .theme-icon {
    font-size: 1.5rem;
    line-height: 1;
  }

  @media (max-width: 768px) {
    .theme-toggle {
      width: 2.5rem;
      height: 2.5rem;
      top: 0.75rem;
      right: 0.75rem;
    }
    
    .theme-icon {
      font-size: 1.25rem;
    }
  }
</style>

<script>
  function initThemeToggle() {
    const btn = document.getElementById('theme-toggle') as HTMLButtonElement;
    if (!btn) return;

    const getIcon = (theme: string) => {
      switch (theme) {
        case 'light':
          return 'â˜€ï¸';
        case 'dark':
          return 'ðŸŒ™';
        default:
          return 'ðŸ”„';
      }
    };

    const applyTheme = (newTheme: 'light' | 'dark' | 'auto') => {
      const html = document.documentElement;
      
      if (newTheme === 'auto') {
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        html.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
      } else {
        html.setAttribute('data-theme', newTheme);
      }
      
      localStorage.setItem('theme', newTheme);
      const icon = btn.querySelector('.theme-icon');
      if (icon) icon.textContent = getIcon(newTheme);
      btn.title = `Current: ${newTheme}`;
    };

    // Initialize with saved theme
    const savedTheme = (localStorage.getItem('theme') as 'light' | 'dark' | 'auto') || 'auto';
    applyTheme(savedTheme);

    // Handle clicks
    btn.addEventListener('click', () => {
      const modes: ('auto' | 'light' | 'dark')[] = ['auto', 'light', 'dark'];
      const currentIndex = modes.indexOf(savedTheme);
      const nextTheme = modes[(currentIndex + 1) % 3];
      applyTheme(nextTheme);
    });
  }

  // Run when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initThemeToggle);
  } else {
    initThemeToggle();
  }
</script>
